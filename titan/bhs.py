
def build_helper_structures(df):

    d = {}

    def addit(x,y):
        if x in d:
            d[x].append(y)
        else:
            d[x] = [y]




    # dictionary that associates storms (SimpleNum) with time step
    storms_by_time_step = {}
    # dictionary? dataframe? or just use the original df?  that associates storm (SimpleNum) with centroid, parents, and children
    simple_storm_info = {}

    # use df.apply(lambda x: axis=1)    

#    for row in df:
#        utc = row['date_utc']
#        simple_num = row['SimpleNum']
#        if utc in storms_by_time_step:
#            storms_by_time_step[utc].append(simple_num)
#        else:
#            storms_by_time_step[utc] = [simple_num]
       
   
    #if simple_num in simple_storm_info:
        #simple_storm_info[ 
       

    #utc1 = r['date_utc']
    #k1 = utc1.iloc[0].isoformat()
    df.apply(lambda r: addit(r['date_utc'].isoformat(), r['SimpleNum']), axis = 1)    
    # df.apply(lambda r: addit(r['date_utc'], r['SimpleNum']), axis = 1)    

    return d # storms_by_time_step, simple_storm_info


# built structure looks like this ...
#>>> d
#{
#Timestamp('2022-05-21 14:59:49+0000', tz='UTC'): ['0', '1', '2', '3'], 
#Timestamp('2022-05-21 15:05:50+0000', tz='UTC'): ['1', '4', '5', '6', '7'], 
#Timestamp('2022-05-21 15:11:48+0000', tz='UTC'): ['4', '9', '12', '13', '10'], 
#Timestamp('2022-05-21 15:17:48+0000', tz='UTC'): ['4', '15', '17', '18', '19', '20', '10'], 
#Timestamp('2022-05-21 15:23:49+0000', tz='UTC'): ['4', '19', '21', '22', '23', '10', '24', '25'], 
#Timestamp('2022-05-21 15:29:49+0000', tz='UTC'): ['22', '23', '29', '30', '31', '32', '33', '38', '10', '24', '25', '35'], 
#Timestamp('2022-05-21 15:35:48+0000', tz='UTC'): ['22', '23', '30', '38', '39', '40', '43', '44', '10', '24', '25', '35', '42'], 
#Timestamp('2022-05-21 15:41:49+0000', tz='UTC'): ['23', '30', '38', '44', '49', '51', '53', '10', '25', '35', '42', '47', '55'], 
#Timestamp('2022-05-21 15:47:48+0000', tz='UTC'): ['23', '30', '51', '58', '59', '60', '61', '63', '10', '25', '35', '42', '47', '55', '57'], 
#Timestamp('2022-05-21 15:53:53+0000', tz='UTC'): ['30', '59', '61', '66', '10', '35', '47', '55', '57'], 
#Timestamp('2022-05-21 15:59:49+0000', tz='UTC'): ['70', '75', '10', '47', '72', '73', '74', '57'], 
#Timestamp('2022-05-21 16:05:49+0000', tz='UTC'): ['75', '76', '78', '47', '72'], 
#Timestamp('2022-05-21 16:11:49+0000', tz='UTC'): ['75', '79', '80', '81', '47'], 
#Timestamp('2022-05-21 16:17:49+0000', tz='UTC'): ['75', '81', '82', '84', '47'], 
#Timestamp('2022-05-21 16:23:49+0000', tz='UTC'): ['81', '85', '47'], 
#Timestamp('2022-05-21 16:29:50+0000', tz='UTC'): ['81', '87', '88', '90', '47', '92'], 
#Timestamp('2022-05-21 16:35:49+0000', tz='UTC'): ['81', '93', '94', '92'], 
#Timestamp('2022-05-21 16:41:49+0000', tz='UTC'): ['81', '94', '92'], 
#Timestamp('2022-05-21 16:47:49+0000', tz='UTC'): ['81', '98', '100', '101', '102', '103', '92'], 
#Timestamp('2022-05-21 16:53:49+0000', tz='UTC'): ['81', '106', '107', '104', '105', '108'], 
#Timestamp('2022-05-21 16:59:48+0000', tz='UTC'): ['81', '111', '114', '104', '105'], 
#Timestamp('2022-05-21 17:05:48+0000', tz='UTC'): ['81', '116', '115'], 
#Timestamp('2022-05-21 17:11:48+0000', tz='UTC'): ['119', '120', '122', '115'], 
#Timestamp('2022-05-21 17:23:50+0000', tz='UTC'): ['122', '125', '127', '128', '129', '130', '131', '132', '115'], 
#Timestamp('2022-05-21 17:29:49+0000', tz='UTC'): ['127', '132', '133', '134', '135', '136', '137', '138', '139', '141'], 
#Timestamp('2022-05-21 17:35:50+0000', tz='UTC'): ['127', '132', '142', '143', '144', '145', '146'], 
#Timestamp('2022-05-21 17:41:49+0000', tz='UTC'): ['132', '144', '147', '148', '149', '150', '152'], 
#Timestamp('2022-05-21 17:47:49+0000', tz='UTC'): ['132', '152', '155', '153'], 
#Timestamp('2022-05-21 17:53:48+0000', tz='UTC'): ['132', '152', '155', '153'], 
#Timestamp('2022-05-21 17:59:48+0000', tz='UTC'): ['152', '159', '160', '153'], 
#Timestamp('2022-05-21 18:05:48+0000', tz='UTC'): ['152', '162', '163', '165'], 
#Timestamp('2022-05-21 18:11:49+0000', tz='UTC'): ['166', '167', '168'], 
#Timestamp('2022-05-21 18:17:49+0000', tz='UTC'): ['166', '172'], 
#Timestamp('2022-05-21 18:23:50+0000', tz='UTC'): ['173', '174', '175', '176', '172'], 
#Timestamp('2022-05-21 18:29:49+0000', tz='UTC'): ['173', '178', '180', '172'], 
#Timestamp('2022-05-21 18:35:48+0000', tz='UTC'): ['180', '181', '182', '184', '172'], 
#Timestamp('2022-05-21 18:41:49+0000', tz='UTC'): ['184', '186', '187', '172'], 
#Timestamp('2022-05-21 18:47:48+0000', tz='UTC'): ['189', '190', '191', '195', '196', '172'], 
#Timestamp('2022-05-21 18:53:49+0000', tz='UTC'): ['191', '197', '199', '172']}
#
